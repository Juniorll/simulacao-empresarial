<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EmpresaTec - Simulação Empresarial Completa</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Botão de Logout -->
    <div id="logoutContainer" class="logout-container hidden">
        <button type="button" class="btn btn--logout" id="logoutBtn">
            <svg class="logout-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                <polyline points="16,17 21,12 16,7"></polyline>
                <line x1="21" y1="12" x2="9" y2="12"></line>
            </svg>
            Sair
        </button>
        <div class="user-info">
            <span class="user-email" id="userEmail">Usuário</span>
        </div>
    </div>

    <!-- Barra de Progresso Global -->
    <div class="progress-container hidden" id="progressContainer">
        <div class="progress-header">
            <h4 id="gameTitle">EmpresaTec - Ato 1 de 5</h4>
            <div class="progress-text" id="progressText">Fase 1 de 5</div>
        </div>
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        <div class="act-navigation">
            <button class="btn btn--xs btn--outline" id="prevActBtn" disabled>← Ato Anterior</button>
            <div class="current-score">Pontuação: <span id="currentScore">0</span></div>
            <button class="btn btn--xs btn--outline" id="nextActBtn" disabled>Próximo Ato →</button>
        </div>
    </div>

    <!-- ===== TELA DE LOGIN ===== -->
    <div class="screen active" id="loginScreen">
        <div class="container">
            <div class="login-card">
                <div class="logo">
                    <h1>🏢 EmpresaTec</h1>
                    <div class="subtitle">Simulação Empresarial Completa - 5 Atos</div>
                </div>
                <p class="welcome-text">
                    Bem-vindo à simulação empresarial mais completa! 
                    Gerencie sua empresa através de 5 atos desafiadores envolvendo custos, 
                    qualidade, tecnologia e tomada de decisão estratégica.
                </p>
                <form id="loginForm">
                    <div class="form-group">
                        <label class="form-label" for="email">Email</label>
                        <input type="email" id="email" class="form-control" required placeholder="seu@email.com">
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="password">Senha</label>
                        <input type="password" id="password" class="form-control" required placeholder="Digite sua senha">
                    </div>
                    <button type="submit" class="btn btn--primary btn--full-width">
                        <span>Entrar no EmpresaTec</span>
                        <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M5 12h14M12 5l7 7-7 7"/>
                        </svg>
                    </button>
                </form>
                <div class="teacher-access">
                    <button type="button" class="btn btn--outline btn--sm" id="teacherBtn">👩‍🏫 Painel Professor</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ===== SELEÇÃO DE EQUIPE ===== -->
    <div class="screen" id="teamScreen">
        <div class="container">
            <div class="screen-header">
                <h2>📋 Formação de Equipe Empresarial</h2>
                <p class="screen-description">
                    Forme sua equipe de 3-6 membros para enfrentar os 5 atos da simulação. 
                    Cada membro terá um papel crucial no sucesso da empresa!
                </p>
            </div>

            <div class="team-options">
                <div class="option-card" id="createTeamCard">
                    <div class="option-icon">👑</div>
                    <h3>Criar Nova Empresa</h3>
                    <p>Seja o CEO fundador e forme uma nova empresa virtual</p>
                    <div class="form-group">
                        <input type="text" id="teamName" class="form-control" placeholder="Nome da sua empresa" maxlength="50">
                    </div>
                    <button class="btn btn--primary" id="createTeamBtn">🚀 Fundar Empresa</button>
                </div>

                <div class="option-card" id="joinTeamCard">
                    <div class="option-icon">👥</div>
                    <h3>Entrar em Empresa</h3>
                    <p>Use o código fornecido pelo CEO da empresa</p>
                    <div class="form-group">
                        <input type="text" id="teamCode" class="form-control" placeholder="Código da empresa" maxlength="10">
                    </div>
                    <button class="btn btn--secondary" id="joinTeamBtn">🤝 Entrar na Empresa</button>
                </div>
            </div>

            <div class="team-status hidden" id="teamStatus">
                <div class="team-info">
                    <h3 id="teamNameDisplay">Minha Empresa</h3>
                    <div class="team-code-display">
                        <span>Código da Empresa: </span>
                        <code id="teamCodeDisplay">ABC123</code>
                        <button class="btn btn--outline btn--xs" id="copyCodeBtn">📋 Copiar</button>
                    </div>
                </div>

                <div class="members-section">
                    <h4>👥 Equipe Executiva</h4>
                    <div class="members-list" id="membersList"></div>
                    <div class="members-waiting" id="membersWaiting">
                        <p>⏳ Aguardando mais membros se juntarem...</p>
                        <div class="recommended-size">Recomendado: 3-6 executivos</div>
                    </div>
                </div>

                <div class="leader-actions hidden" id="leaderActions">
                    <button class="btn btn--success btn--large" id="startAct1Btn">
                        ✨ Iniciar Ato 1 - Fundação
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ===== ATO 1: FUNDAÇÃO DA EMPRESA ===== -->
    <div class="screen" id="act1Screen">
        <div class="container">
            <div class="act-header">
                <h2>🏗️ Ato 1: Fundação da Empresa</h2>
                <p class="act-description">
                    Estabeleça as bases sólidas da sua empresa. Defina perfis, escolha o segmento, 
                    estruture a organização e aloque o orçamento inicial de R$ 500.000.
                </p>
                <div class="act-progress">
                    <span>Fase <span id="act1Phase">1</span> de 5</span>
                    <div class="budget-display">Orçamento: R$ <span id="act1Budget">500.000</span></div>
                </div>
            </div>

            <!-- Fase 1: Perfis Profissionais -->
            <div class="phase-content active" id="act1Phase1">
                <div class="phase-card">
                    <h3>🧠 Fase 1: Descoberta de Perfis Profissionais</h3>
                    <p>Cada membro deve descobrir seu perfil para formar uma equipe equilibrada.</p>

                    <div class="questionnaire-container">
                        <div class="question-card active" id="profileQuestion">
                            <h4 id="questionText">Carregando pergunta...</h4>
                            <div class="question-options" id="questionOptions">
                                <!-- Opções serão carregadas dinamicamente -->
                            </div>
                        </div>

                        <div class="question-navigation">
                            <button class="btn btn--outline" id="prevQuestionBtn" disabled>⬅ Anterior</button>
                            <div class="question-counter">
                                Pergunta <span id="currentQuestionNum">1</span> de <span id="totalQuestions">10</span>
                            </div>
                            <button class="btn btn--primary" id="nextQuestionBtn" disabled>Próxima ➡</button>
                            <button class="btn btn--success hidden" id="finishProfileBtn">✅ Finalizar Perfil</button>
                        </div>
                    </div>
                </div>

                <div class="phase-actions">
                    <button class="btn btn--success btn--large hidden" id="continueToSegmentBtn">
                        Continuar para Escolha do Segmento ➡
                    </button>
                </div>
            </div>

            <!-- Fase 2: Escolha do Segmento -->
            <div class="phase-content" id="act1Phase2">
                <div class="phase-card">
                    <h3>🏭 Fase 2: Escolha do Segmento Empresarial</h3>
                    <p>Escolha o segmento tecnológico onde sua empresa irá atuar. Esta decisão impactará todas as fases seguintes.</p>

                    <div class="segments-grid" id="segmentsGrid">
                        <!-- Segmentos serão carregados dinamicamente -->
                    </div>

                    <div class="voting-section">
                        <h4>🗳️ Votação da Equipe</h4>
                        <div class="vote-status" id="voteStatus">Aguardando votos...</div>
                        <button class="btn btn--primary btn--large hidden" id="submitSegmentVoteBtn">
                            📊 Confirmar Voto
                        </button>
                    </div>
                </div>

                <div class="phase-actions">
                    <button class="btn btn--success btn--large hidden" id="continueToStructureBtn">
                        Continuar para Estrutura Organizacional ➡
                    </button>
                </div>
            </div>

            <!-- Fase 3: Estrutura Organizacional -->
            <div class="phase-content" id="act1Phase3">
                <div class="phase-card">
                    <h3>👔 Fase 3: Estrutura Organizacional</h3>
                    <p>Defina a hierarquia e os cargos executivos da empresa.</p>

                    <div class="org-structure">
                        <div class="ceo-election">
                            <h4>👑 Eleição do CEO</h4>
                            <div class="candidates-grid" id="candidatesGrid">
                                <!-- Candidatos serão listados -->
                            </div>
                            <button class="btn btn--primary btn--large hidden" id="submitCEOVoteBtn">
                                ✅ Votar para CEO
                            </button>
                        </div>

                        <div class="positions-assignment hidden" id="positionsAssignment">
                            <h4>📋 Atribuição de Cargos (CEO)</h4>
                            <div class="positions-grid" id="positionsGrid">
                                <!-- Grid de atribuições -->
                            </div>
                            <button class="btn btn--primary btn--large" id="confirmPositionsBtn">
                                ✅ Confirmar Cargos
                            </button>
                        </div>
                    </div>
                </div>

                <div class="phase-actions">
                    <button class="btn btn--success btn--large hidden" id="continueToLocationBtn">
                        Continuar para Localização da Sede ➡
                    </button>
                </div>
            </div>

            <!-- Fase 4: Localização e Sede -->
            <div class="phase-content" id="act1Phase4">
                <div class="phase-card">
                    <h3>🏢 Fase 4: Localização da Sede</h3>
                    <p>Escolha a localização e o tipo de sede da empresa. Decisão impacta custos operacionais.</p>

                    <div class="location-options">
                        <div class="location-grid">
                            <div class="location-card" data-location="centro">
                                <h4>🏙️ Centro Empresarial</h4>
                                <div class="location-details">
                                    <p><strong>Custo:</strong> R$ 200.000</p>
                                    <p><strong>Vantagens:</strong> Prestígio, acessibilidade</p>
                                    <p><strong>Desvantagens:</strong> Alto custo, trânsito</p>
                                </div>
                            </div>

                            <div class="location-card" data-location="tecnologico">
                                <h4>🔬 Parque Tecnológico</h4>
                                <div class="location-details">
                                    <p><strong>Custo:</strong> R$ 150.000</p>
                                    <p><strong>Vantagens:</strong> Inovação, networking</p>
                                    <p><strong>Desvantagens:</strong> Distância, especialização</p>
                                </div>
                            </div>

                            <div class="location-card" data-location="coworking">
                                <h4>🏢 Coworking Premium</h4>
                                <div class="location-details">
                                    <p><strong>Custo:</strong> R$ 80.000</p>
                                    <p><strong>Vantagens:</strong> Flexibilidade, custo</p>
                                    <p><strong>Desvantagens:</strong> Menos privacidade</p>
                                </div>
                            </div>

                            <div class="location-card" data-location="home">
                                <h4>🏠 Home Office</h4>
                                <div class="location-details">
                                    <p><strong>Custo:</strong> R$ 30.000</p>
                                    <p><strong>Vantagens:</strong> Economia, flexibilidade</p>
                                    <p><strong>Desvantagens:</strong> Imagem, colaboração</p>
                                </div>
                            </div>
                        </div>

                        <button class="btn btn--primary btn--large hidden" id="confirmLocationBtn">
                            ✅ Confirmar Localização
                        </button>
                    </div>
                </div>

                <div class="phase-actions">
                    <button class="btn btn--success btn--large hidden" id="continueToEquipmentBtn">
                        Continuar para Equipamentos ➡
                    </button>
                </div>
            </div>

            <!-- Fase 5: Equipamentos e Orçamento -->
            <div class="phase-content" id="act1Phase5">
                <div class="phase-card">
                    <h3>💻 Fase 5: Equipamentos e Orçamento Final</h3>
                    <p>Aloque o orçamento restante em equipamentos e licenças necessárias.</p>

                    <div class="budget-allocation">
                        <div class="budget-summary">
                            <h4>💰 Resumo Orçamentário</h4>
                            <div class="budget-line">
                                <span>Orçamento Inicial:</span>
                                <span>R$ 500.000</span>
                            </div>
                            <div class="budget-line spent">
                                <span>Gastos até agora:</span>
                                <span id="totalSpent">R$ 0</span>
                            </div>
                            <div class="budget-line remaining">
                                <span>Saldo Disponível:</span>
                                <span id="remainingBudget">R$ 500.000</span>
                            </div>
                        </div>

                        <div class="equipment-options">
                            <h4>🛠️ Equipamentos Disponíveis</h4>
                            <div class="equipment-grid">
                                <div class="equipment-card" data-equipment="basic">
                                    <h5>💻 Equipamentos Básicos</h5>
                                    <p>Computadores, impressoras, mobiliário</p>
                                    <div class="equipment-cost">R$ 30.000</div>
                                    <button class="btn btn--outline equipment-btn">Adquirir</button>
                                </div>

                                <div class="equipment-card" data-equipment="advanced">
                                    <h5>🖥️ Equipamentos Avançados</h5>
                                    <p>Workstations, servidores, equipamentos especializados</p>
                                    <div class="equipment-cost">R$ 80.000</div>
                                    <button class="btn btn--outline equipment-btn">Adquirir</button>
                                </div>

                                <div class="equipment-card" data-equipment="software">
                                    <h5>⚙️ Licenças de Software</h5>
                                    <p>Pacote Office, ferramentas desenvolvimento, design</p>
                                    <div class="equipment-cost">R$ 15.000</div>
                                    <button class="btn btn--outline equipment-btn">Adquirir</button>
                                </div>

                                <div class="equipment-card" data-equipment="security">
                                    <h5>🔒 Segurança e Backup</h5>
                                    <p>Antivírus, firewall, sistema de backup</p>
                                    <div class="equipment-cost">R$ 20.000</div>
                                    <button class="btn btn--outline equipment-btn">Adquirir</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="phase-actions">
                    <button class="btn btn--success btn--large" id="finishAct1Btn">
                        🎯 Finalizar Ato 1
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ===== ATO 2: ESTRUTURAÇÃO OPERACIONAL ===== -->
    <div class="screen" id="act2Screen">
        <div class="container">
            <div class="act-header">
                <h2>⚙️ Ato 2: Estruturação Operacional</h2>
                <p class="act-description">
                    Defina processos, tecnologias e sistemas de qualidade. 
                    Orçamento adicional: R$ 300.000 para operacionalização.
                </p>
                <div class="act-progress">
                    <span>Fase <span id="act2Phase">1</span> de 5</span>
                    <div class="budget-display">Orçamento: R$ <span id="act2Budget">300.000</span></div>
                </div>
            </div>

            <!-- Fases do Ato 2 serão implementadas aqui -->
            <div class="coming-soon">
                <h3>🚧 Implementação Progressiva</h3>
                <p>As fases do Ato 2 serão liberadas após conclusão do Ato 1 por todas as equipes.</p>
                <div class="unlock-requirements">
                    <h4>📋 Requisitos para Desbloqueio:</h4>
                    <ul>
                        <li>✅ Todas as equipes devem completar Ato 1</li>
                        <li>✅ Professor deve aprovar liberação</li>
                        <li>✅ Ranking do Ato 1 deve ser exibido</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- ===== ATO 3: DESENVOLVIMENTO ===== -->
    <div class="screen" id="act3Screen">
        <div class="container">
            <div class="act-header">
                <h2>🔬 Ato 3: Desenvolvimento de Produto/Serviço</h2>
                <p class="act-description">
                    Pesquise, desenvolva e teste sua solução. 
                    Orçamento de P&D: R$ 250.000.
                </p>
            </div>
            <div class="coming-soon">
                <h3>🔒 Ato Bloqueado</h3>
                <p>Será liberado após aprovação do professor no Ato 2.</p>
            </div>
        </div>
    </div>

    <!-- ===== ATO 4: LANÇAMENTO ===== -->
    <div class="screen" id="act4Screen">
        <div class="container">
            <div class="act-header">
                <h2>🚀 Ato 4: Lançamento no Mercado</h2>
                <p class="act-description">
                    Estratégias de marketing e vendas. 
                    Orçamento de lançamento: R$ 400.000.
                </p>
            </div>
            <div class="coming-soon">
                <h3>🔒 Ato Bloqueado</h3>
                <p>Será liberado após aprovação do professor no Ato 3.</p>
            </div>
        </div>
    </div>

    <!-- ===== ATO 5: EXPANSÃO ===== -->
    <div class="screen" id="act5Screen">
        <div class="container">
            <div class="act-header">
                <h2>📈 Ato 5: Crescimento e Expansão</h2>
                <p class="act-description">
                    Análise de resultados e estratégias futuras. 
                    Orçamento de expansão: R$ 600.000.
                </p>
            </div>
            <div class="coming-soon">
                <h3>🔒 Ato Bloqueado</h3>
                <p>Será liberado após aprovação do professor no Ato 4.</p>
            </div>
        </div>
    </div>

    <!-- ===== RANKING E RESULTADOS ===== -->
    <div class="screen" id="rankingScreen">
        <div class="container">
            <div class="screen-header">
                <h2>🏆 Ranking - <span id="rankingTitle">Ato 1</span></h2>
                <p class="screen-description">Resultados e classificação das equipes</p>
            </div>

            <div class="ranking-content">
                <div class="ranking-summary">
                    <h3>📊 Resumo Geral</h3>
                    <div class="summary-stats" id="summaryStats">
                        <!-- Estatísticas gerais -->
                    </div>
                </div>

                <div class="ranking-table">
                    <h3>🏅 Classificação Final</h3>
                    <div class="ranking-list" id="rankingList">
                        <!-- Lista de ranking -->
                    </div>
                </div>

                <div class="professor-approval">
                    <h3>👩‍🏫 Aprovação do Professor</h3>
                    <div class="approval-status" id="approvalStatus">
                        Aguardando aprovação do professor para liberar próximo ato...
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ===== PAINEL DO PROFESSOR ===== -->
    <div class="screen" id="teacherScreen">
        <div class="container">
            <div class="screen-header">
                <h2>👩‍🏫 Painel do Professor</h2>
                <p class="screen-description">Controle completo da simulação empresarial</p>
            </div>

            <div class="teacher-dashboard">
                <div class="dashboard-stats">
                    <div class="stat-card">
                        <h4>🏢 Empresas</h4>
                        <div class="stat-number" id="totalTeams">0</div>
                    </div>
                    <div class="stat-card">
                        <h4>👥 Participantes</h4>
                        <div class="stat-number" id="totalParticipants">0</div>
                    </div>
                    <div class="stat-card">
                        <h4>🎭 Ato Atual</h4>
                        <div class="stat-number" id="currentActNumber">1</div>
                    </div>
                    <div class="stat-card">
                        <h4>✅ Completos</h4>
                        <div class="stat-number" id="completedTeams">0</div>
                    </div>
                </div>

                <div class="teacher-controls">
                    <div class="control-section">
                        <h3>🎮 Controle dos Atos</h3>
                        <div class="act-controls">
                            <button class="btn btn--success" id="approveAct1Btn">✅ Aprovar Ato 1</button>
                            <button class="btn btn--success" id="approveAct2Btn" disabled>✅ Aprovar Ato 2</button>
                            <button class="btn btn--success" id="approveAct3Btn" disabled>✅ Aprovar Ato 3</button>
                            <button class="btn btn--success" id="approveAct4Btn" disabled>✅ Aprovar Ato 4</button>
                            <button class="btn btn--success" id="approveAct5Btn" disabled>✅ Aprovar Ato 5</button>
                        </div>
                    </div>

                    <div class="control-section">
                        <h3>📊 Relatórios e Rankings</h3>
                        <div class="report-controls">
                            <button class="btn btn--primary" id="showRankingBtn">🏆 Exibir Ranking</button>
                            <button class="btn btn--outline" id="exportResultsBtn">📤 Exportar Resultados</button>
                            <button class="btn btn--outline" id="generateReportBtn">📋 Gerar Relatório</button>
                        </div>
                    </div>

                    <div class="control-section">
                        <h3>⚙️ Administração</h3>
                        <div class="admin-controls">
                            <button class="btn btn--danger" id="resetSimulationBtn">🔄 Resetar Simulação</button>
                            <button class="btn btn--outline" id="backupDataBtn">💾 Backup Dados</button>
                        </div>
                    </div>

                    <div class="password-section">
                        <label>Senha de Administrador:</label>
                        <input type="password" id="adminPassword" class="form-control" placeholder="Digite a senha">
                    </div>
                </div>

                <div class="teams-monitor">
                    <h3>📋 Monitoramento de Empresas</h3>
                    <div class="teams-grid" id="teacherTeamsGrid">
                        <!-- Grid de monitoramento -->
                    </div>
                </div>
            </div>

            <button class="btn btn--outline" id="backToSimulationBtn">
                ⬅️ Voltar à Simulação
            </button>
        </div>
    </div>

    <!-- Scripts -->
    <script src="empresatec-complete.js"></script>

    <!-- Firebase Configuration -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js';
        import { 
            getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, 
            onAuthStateChanged, signOut 
        } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js';
        import { 
            getFirestore, doc, setDoc, getDoc, deleteDoc, collection, 
            addDoc, updateDoc, onSnapshot, query, where, orderBy, getDocs 
        } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js';

        const firebaseConfig = {
            apiKey: "AIzaSyDUBDKmRSc3BRDtez_g4Cd8VRYOGq6f7JQ",
            authDomain: "simulacao-empresa.firebaseapp.com",
            projectId: "simulacao-empresa",
            storageBucket: "simulacao-empresa.firebasestorage.app",
            messagingSenderId: "454064270255",
            appId: "1:454064270255:web:f3d65cc4fc6018e1715d5a",
            measurementId: "G-029B5VNF4M"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        window.firebaseAuth = auth;
        window.firebaseDB = db;
        window.firebaseUtils = {
            createUserWithEmailAndPassword, signInWithEmailAndPassword,
            onAuthStateChanged, signOut, doc, setDoc, getDoc, deleteDoc,
            collection, addDoc, updateDoc, onSnapshot, query, where, orderBy, getDocs
        };

        // Initialize logout system
        function initLogoutSystem() {
            const logoutBtn = document.getElementById('logoutBtn');
            const logoutContainer = document.getElementById('logoutContainer');
            const userEmail = document.getElementById('userEmail');

            onAuthStateChanged(auth, (user) => {
                if (user) {
                    logoutContainer.classList.remove('hidden');
                    userEmail.textContent = user.email;
                } else {
                    logoutContainer.classList.add('hidden');
                }
            });

            logoutBtn.addEventListener('click', async () => {
                if (confirm('Deseja realmente fazer logout?')) {
                    try {
                        await signOut(auth);
                        localStorage.clear();
                        sessionStorage.clear();
                        window.location.reload();
                    } catch (error) {
                        alert('Erro ao fazer logout: ' + error.message);
                    }
                }
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            initLogoutSystem();
            console.log('✅ EmpresaTec Complete - Firebase inicializado');
        });
    </script>
</body>
</html>
