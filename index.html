<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ATO 1 - Simula√ß√£o Empresarial</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- BOT√ÉO LOGOUT SEMPRE VIS√çVEL -->
<div id="logoutContainer" style="
    position: fixed !important;
    top: 10px !important;
    right: 10px !important;
    z-index: 9999 !important;
    background: white !important;
    border: 2px solid #ff4757 !important;
    border-radius: 8px !important;
    padding: 8px 12px !important;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3) !important;
    display: flex !important;
    align-items: center !important;
    gap: 8px !important;
    font-family: Arial, sans-serif !important;
">
    <button id="logoutBtn" style="
        background: linear-gradient(135deg, #ff4757, #ff3838) !important;
        color: white !important;
        border: none !important;
        border-radius: 6px !important;
        padding: 6px 12px !important;
        font-size: 13px !important;
        font-weight: bold !important;
        cursor: pointer !important;
        display: flex !important;
        align-items: center !important;
        gap: 4px !important;
    ">
        üö™ Sair
    </button>
    <span id="userEmail" style="
        font-size: 11px !important;
        color: #666 !important;
        max-width: 120px !important;
        overflow: hidden !important;
        text-overflow: ellipsis !important;
        white-space: nowrap !important;
    ">Usu√°rio</span>
</div>

<script>
// SISTEMA DE LOGOUT - EXECUTA IMEDIATAMENTE
console.log('üö™ Inicializando sistema de logout...');

// Garantir que o bot√£o sempre apare√ßa
document.getElementById('logoutContainer').style.display = 'flex';

// Fun√ß√£o de logout
document.getElementById('logoutBtn').onclick = async function() {
    console.log('üö™ Bot√£o logout clicado!');
    
    if (confirm('Deseja realmente fazer logout?')) {
        try {
            this.innerHTML = '‚è≥ Saindo...';
            this.disabled = true;
            
            // Logout Firebase (se dispon√≠vel)
            if (window.firebaseAuth && window.firebaseUtils) {
                console.log('üî• Fazendo logout Firebase...');
                await window.firebaseUtils.signOut(window.firebaseAuth);
            }
            
            // Limpar tudo
            localStorage.clear();
            sessionStorage.clear();
            
            console.log('‚úÖ Logout conclu√≠do!');
            alert('Logout realizado com sucesso!');
            
            // Recarregar p√°gina
            window.location.href = window.location.href;
            
        } catch (error) {
            console.error('‚ùå Erro no logout:', error);
            alert('Erro ao fazer logout: ' + error.message);
            this.innerHTML = 'üö™ Sair';
            this.disabled = false;
        }
    }
};

// Atualizar email do usu√°rio
function atualizarUsuario() {
    const emailElement = document.getElementById('userEmail');
    
    // Tentar pegar do Firebase
    if (window.firebaseAuth && window.firebaseAuth.currentUser) {
        emailElement.textContent = window.firebaseAuth.currentUser.email || 'Firebase User';
        return;
    }
    
    // Tentar pegar do localStorage
    const savedEmail = localStorage.getItem('userEmail') || 
                      localStorage.getItem('currentUser') ||
                      localStorage.getItem('user');
    
    if (savedEmail) {
        emailElement.textContent = savedEmail;
        return;
    }
    
    // Pegar do formul√°rio de login se existir
    const emailInput = document.getElementById('email');
    if (emailInput && emailInput.value) {
        emailElement.textContent = emailInput.value;
        return;
    }
    
    emailElement.textContent = 'Usu√°rio Logado';
}

// Executar atualiza√ß√£o a cada 2 segundos
setInterval(atualizarUsuario, 2000);

// Executar imediatamente
atualizarUsuario();

console.log('‚úÖ Sistema de logout ativado!');
</script>
    <div class="logout-container hidden" id="logoutContainer">
    <button type="button" class="btn btn--logout" id="logoutBtn">
        <svg class="logout-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
            <polyline points="16,17 21,12 16,7"></polyline>
            <line x1="21" y1="12" x2="9" y2="12"></line>
        </svg>
        Sair
    </button>
    <div class="user-info" id="userInfo">
        <span class="user-email" id="userEmail"></span>
    </div>
</div>
    <!-- Progress Bar -->
    <div class="progress-container hidden" id="progressContainer">
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        <div class="progress-text" id="progressText">Etapa 1 de 8</div>
    </div>

    <!-- Login Screen -->
    <div class="screen active" id="loginScreen">
        <div class="container">
            <div class="login-card">
                <h1>ATO 1 - Simula√ß√£o Empresarial</h1>
                <p>Entre com suas credenciais para come√ßar o jogo</p>
                <form id="loginForm">
                    <div class="form-group">
                        <label class="form-label" for="email">Email</label>
                        <input type="email" id="email" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="password">Senha</label>
                        <input type="password" id="password" class="form-control" required>
                    </div>
                    <button type="submit" class="btn btn--primary btn--full-width">Entrar</button>
                </form>
                <div class="teacher-access">
                    <button type="button" class="btn btn--outline btn--sm" id="teacherBtn">Acesso Professor</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Team Selection Screen -->
    <div class="screen" id="teamScreen">
        <div class="container">
            <h2>Escolha da Equipe</h2>
            <div class="team-options">
                <div class="card" id="createTeamCard">
                    <div class="card__body">
                        <h3>Criar Nova Equipe</h3>
                        <p>Seja o l√≠der e crie uma nova equipe</p>
                        <div class="form-group">
                            <label class="form-label" for="teamName">Nome da Equipe</label>
                            <input type="text" id="teamName" class="form-control" placeholder="Digite o nome da sua equipe">
                        </div>
                        <button class="btn btn--primary" id="createTeamBtn">Criar Equipe</button>
                    </div>
                </div>
                <div class="card" id="joinTeamCard">
                    <div class="card__body">
                        <h3>Entrar em Equipe</h3>
                        <p>Junte-se a uma equipe existente</p>
                        <div class="form-group">
                            <label class="form-label" for="teamCode">C√≥digo da Equipe</label>
                            <input type="text" id="teamCode" class="form-control" placeholder="Digite o c√≥digo da equipe">
                        </div>
                        <button class="btn btn--primary" id="joinTeamBtn">Entrar na Equipe</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Team Waiting Screen -->
    <div class="screen" id="waitingScreen">
        <div class="container">
            <div class="team-info">
                <h2 id="currentTeamName">Equipe: </h2>
                <p>C√≥digo da equipe: <strong id="currentTeamCode"></strong></p>
                <div class="members-list">
                    <h3>Membros da Equipe</h3>
                    <div id="membersList"></div>
                </div>
                <div class="leader-actions hidden" id="leaderActions">
                    <button class="btn btn--primary" id="startGameBtn">Iniciar Jogo</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Quiz Screen -->
    <div class="screen" id="quizScreen">
        <div class="container">
            <h2>Question√°rio de Perfil Profissional</h2>
            <div class="quiz-container">
                <div class="question-card" id="questionCard">
                    <div class="question-number" id="questionNumber">Pergunta 1 de 10</div>
                    <h3 id="questionText"></h3>
                    <div class="options-container" id="optionsContainer"></div>
                    <div class="quiz-navigation">
                        <button class="btn btn--outline" id="prevBtn" disabled>Anterior</button>
                        <button class="btn btn--primary" id="nextBtn" disabled>Pr√≥xima</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Profile Results Screen -->
    <div class="screen" id="profileScreen">
        <div class="container">
            <h2>Resultados dos Perfis Profissionais</h2>
            <div class="profile-results">
                <div class="my-profile">
                    <h3>Seu Perfil</h3>
                    <div class="profile-card" id="myProfileCard"></div>
                </div>
                <div class="team-profiles">
                    <h3>Perfis da Equipe</h3>
                    <div id="teamProfilesList"></div>
                </div>
                <div class="leader-actions hidden" id="profileLeaderActions">
                    <button class="btn btn--primary" id="continueToSegmentBtn">Continuar para Escolha do Segmento</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Segment Selection Screen -->
    <div class="screen" id="segmentScreen">
        <div class="container">
            <h2>Escolha do Segmento de Empresa</h2>
            <div class="segments-grid" id="segmentsGrid"></div>
            <div class="voting-section">
                <button class="btn btn--primary" id="voteSegmentBtn" disabled>Votar no Segmento Selecionado</button>
            </div>
            <div class="voting-results hidden" id="segmentResults">
                <h3>Resultado da Vota√ß√£o</h3>
                <div id="segmentResultsContent"></div>
                <div class="leader-actions hidden" id="segmentLeaderActions">
                    <button class="btn btn--primary" id="continueToCeoBtn">Continuar para Elei√ß√£o do CEO</button>
                </div>
            </div>
        </div>
    </div>

    <!-- CEO Election Screen -->
    <div class="screen" id="ceoScreen">
        <div class="container">
            <h2>Elei√ß√£o do CEO</h2>
            <p>Vote secretamente em quem deve ser o CEO da sua equipe</p>
            <div class="candidates-list" id="candidatesList"></div>
            <div class="voting-section">
                <button class="btn btn--primary" id="voteCeoBtn" disabled>Confirmar Voto</button>
            </div>
            <div class="ceo-results hidden" id="ceoResults">
                <h3>Resultado da Elei√ß√£o</h3>
                <div id="ceoResultsContent"></div>
                <div class="satisfaction-section" id="satisfactionSection">
                    <h4>Avalie sua satisfa√ß√£o com o resultado:</h4>
                    <div class="satisfaction-scale">
                        <input type="range" min="1" max="10" value="5" id="satisfactionSlider">
                        <div class="scale-labels">
                            <span>Muito Insatisfeito</span>
                            <span>Muito Satisfeito</span>
                        </div>
                    </div>
                    <button class="btn btn--primary" id="submitSatisfactionBtn">Enviar Avalia√ß√£o</button>
                </div>
                <div class="ceo-actions hidden" id="ceoActions">
                    <button class="btn btn--primary" id="continueToPositionsBtn">Definir Cargos da Equipe</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Position Assignment Screen -->
    <div class="screen" id="positionScreen">
        <div class="container">
            <h2>Defini√ß√£o de Cargos</h2>
            <div class="positions-assignment" id="positionsAssignment">
                <div class="team-members" id="teamMembersForPositions"></div>
                <div class="available-positions" id="availablePositions"></div>
                <button class="btn btn--primary" id="confirmPositionsBtn">Confirmar Cargos</button>
            </div>
            <div class="positions-results hidden" id="positionsResults">
                <h3>Cargos Definidos</h3>
                <div id="positionsResultsContent"></div>
                <div class="satisfaction-section" id="positionsSatisfactionSection">
                    <h4>Avalie sua satisfa√ß√£o com os cargos definidos:</h4>
                    <div class="satisfaction-scale">
                        <input type="range" min="1" max="10" value="5" id="positionsSatisfactionSlider">
                        <div class="scale-labels">
                            <span>Muito Insatisfeito</span>
                            <span>Muito Satisfeito</span>
                        </div>
                    </div>
                    <button class="btn btn--primary" id="submitPositionsSatisfactionBtn">Enviar Avalia√ß√£o</button>
                </div>
                <div class="continue-actions hidden" id="continueToHiringActions">
                    <button class="btn btn--primary" id="continueToHiringBtn">Continuar para Contrata√ß√µes</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Hiring Screen -->
    <div class="screen" id="hiringScreen">
        <div class="container">
            <h2>Processo de Contrata√ß√£o</h2>
            <div class="hiring-phase-1" id="hiringPhase1">
                <h3>Suas Responsabilidades como <span id="memberPosition"></span></h3>
                <p id="positionDescription"></p>
                <h4>Selecione as contrata√ß√µes necess√°rias para sua √°rea:</h4>
                <div class="hiring-options" id="hiringOptions"></div>
                <button class="btn btn--primary" id="submitHiringNeedsBtn">Enviar Necessidades</button>
            </div>
            <div class="hiring-phase-2 hidden" id="hiringPhase2">
                <h3>Decis√£o Final do CEO</h3>
                <div class="budget-info">
                    <h4>Or√ßamento Dispon√≠vel: R$ <span id="availableBudget">50.000</span></h4>
                </div>
                <div class="team-requests" id="teamRequests"></div>
                <div class="final-decisions" id="finalDecisions"></div>
                <button class="btn btn--primary" id="confirmHiringBtn">Confirmar Contrata√ß√µes</button>
            </div>
            <div class="hiring-results hidden" id="hiringResults">
                <h3>Organograma Final</h3>
                <div id="finalOrganogram"></div>
                <div class="satisfaction-section" id="hiringSatisfactionSection">
                    <h4>Avalie as decis√µes do CEO:</h4>
                    <div class="satisfaction-scale">
                        <input type="range" min="1" max="10" value="5" id="hiringSatisfactionSlider">
                        <div class="scale-labels">
                            <span>Muito Insatisfeito</span>
                            <span>Muito Satisfeito</span>
                        </div>
                    </div>
                    <button class="btn btn--primary" id="submitHiringSatisfactionBtn">Enviar Avalia√ß√£o</button>
                </div>
                <div class="continue-actions hidden" id="continueToReportActions">
                    <button class="btn btn--primary" id="continueToReportBtn">Ver Relat√≥rio Final</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Final Report Screen -->
    <div class="screen" id="reportScreen">
        <div class="container">
            <h2>Relat√≥rio Final - ATO 1</h2>
            <div class="final-report" id="finalReport">
                <div class="total-score">
                    <h3>Pontua√ß√£o Total da Equipe: <span id="totalScore">0</span> pontos</h3>
                </div>
                <div class="score-breakdown" id="scoreBreakdown"></div>
                <div class="team-ranking" id="teamRanking"></div>
                <button class="btn btn--secondary" id="restartBtn">Reiniciar Jogo</button>
            </div>
        </div>
    </div>

    <!-- Teacher Panel -->
    <div class="screen" id="teacherScreen">
        <div class="container">
            <h2>Painel do Professor</h2>
            <div class="teacher-controls">
                <div class="control-buttons">
                    <button class="btn btn--primary" id="toggleScoresBtn">Revelar/Ocultar Pontua√ß√µes</button>
                    <button class="btn btn--warning" id="resetGameBtn">Zerar Todas as Informa√ß√µes</button>
                    <button class="btn btn--outline" id="backToLoginBtn">Voltar ao Login</button>
                </div>
                <div class="teams-overview" id="teamsOverview"></div>
            </div>
        </div>
    </div>

    <!-- Teacher Password Modal -->
    <div class="modal hidden" id="teacherModal">
        <div class="modal-content">
            <h3>Acesso do Professor</h3>
            <div class="form-group">
                <label class="form-label" for="teacherPassword">Senha do Professor</label>
                <input type="password" id="teacherPassword" class="form-control">
                <small>Senha padr√£o: professor123</small>
            </div>
            <div class="modal-actions">
                <button class="btn btn--outline" id="cancelTeacherBtn">Cancelar</button>
                <button class="btn btn--primary" id="confirmTeacherBtn">Confirmar</button>
            </div>
        </div>
    </div>

    <!-- Notification System -->
    <div class="notification hidden" id="notification">
        <div class="notification-content" id="notificationContent"></div>
    </div>

    <script src="app.js"></script>
    <!-- Firebase SDKs -->
<script type="module">
import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js';
import { getAuth } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js';
import { getFirestore } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js';

// COLE AQUI SUA CONFIGURA√á√ÉO FIREBASE
const firebaseConfig = {
  apiKey: "AIzaSyDUBDKmRSc3BRDtez_g4Cd8VRYOGq6f7JQ",
  authDomain: "simulacao-empresa.firebaseapp.com",
  projectId: "simulacao-empresa",
  storageBucket: "simulacao-empresa.firebasestorage.app",
  messagingSenderId: "454064270255",
  appId: "1:454064270255:web:f3d65cc4fc6018e1715d5a",
  measurementId: "G-029B5VNF4M"
};

const app = initializeApp(firebaseConfig);
window.firebaseAuth = getAuth(app);
window.firebaseDB = getFirestore(app);
</script>

<!-- SISTEMA DE LOGOUT COMPLETO -->
<script>
document.addEventListener('DOMContentLoaded', () => {
    // Aguardar Firebase carregar
    setTimeout(() => {
        const logoutBtn = document.getElementById('logoutBtn');
        const logoutContainer = document.getElementById('logoutContainer');
        const userEmail = document.getElementById('userEmail');
        
        // Fun√ß√£o de logout
        if (logoutBtn) {
            logoutBtn.addEventListener('click', async () => {
                try {
                    logoutBtn.disabled = true;
                    logoutBtn.innerHTML = 'Saindo...';
                    
                    // Logout Firebase (se dispon√≠vel)
                    if (window.firebaseAuth && window.firebaseUtils) {
                        await window.firebaseUtils.signOut(window.firebaseAuth);
                    }
                    
                    // Limpar dados locais
                    localStorage.clear();
                    
                    // Feedback e redirecionamento
                    alert('Logout realizado com sucesso!');
                    window.location.reload();
                    
                } catch (error) {
                    console.error('Erro logout:', error);
                    alert('Erro: ' + error.message);
                    logoutBtn.disabled = false;
                    logoutBtn.innerHTML = 'Sair';
                }
            });
        }

        // Monitor de autentica√ß√£o (funciona com ou sem Firebase)
        function checkAuthState() {
            // Se Firebase dispon√≠vel
            if (window.firebaseAuth && window.firebaseUtils) {
                window.firebaseUtils.onAuthStateChanged(window.firebaseAuth, (user) => {
                    if (user && logoutContainer) {
                        logoutContainer.classList.remove('hidden');
                        if (userEmail) userEmail.textContent = user.email;
                    } else if (logoutContainer) {
                        logoutContainer.classList.add('hidden');
                    }
                });
            } 
            // Fallback simples
            else {
                const savedEmail = localStorage.getItem('userEmail');
                if (savedEmail && logoutContainer) {
                    logoutContainer.classList.remove('hidden');
                    if (userEmail) userEmail.textContent = savedEmail;
                }
            }
        }
        
        checkAuthState();
        
    }, 1000); // Aguarda 1 segundo para Firebase carregar
});
</script>
    
</body>
</html>
